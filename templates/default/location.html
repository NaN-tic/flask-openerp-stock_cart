{% extends "default/layout.html" %}{% from "default/_helpers.html" import render_field %}
{% block title %}{{ _("Product location") }}{% endblock %}
{% block body %}
{% include 'default/nav.html' %}
<div class="row visible-lg visible-md">
    <div class="col-md-12">
        <h2 class="title-box">{{ _("Product location") }}</h2>
    </div>
</div>

<script type="text/javascript">
$(function() {
    $("#product-save-location").click(function() {  
        $('#message-save').text('{{ _("Sending") }}...');

        var data = $('#location-form').serializeArray();

        $.ajax({
            type: "POST",
            url: "{{ url_for('product_save_location') }}",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(data),
            success: function(data) {
                $('#message-save').text(data.message);
                $('#message-save').css('color', data.color);
                $('#ean13').val('');
                },
            error:function(data){
                $('#message-save').text("{{ _('Wrong user access or connection server error. Try again.') }}");
                $('#message-save').css('color', 'red');
                },
            });
        return false;
    });  

    $("#product-get-location").click(function() {  
        $('#message-get').text('{{ _("Sending") }}...');

        var data = $('#product-form').serializeArray();

        $.ajax({
            type: "POST",
            url: "{{ url_for('product_get_location') }}",
            contentType: "application/json; charset=utf-8",
            data:JSON.stringify(data),
            success: function(data) {
                $('#message-get').text(data.message);
                $('#message-get').css('color', data.color);
                $('#product-ean13').val('');
                },
            error:function(data){
                $('#message-get').text("{{ _('Wrong user access or connection server error. Try again.') }}");
                $('#message-get').css('color', 'red');
                },
            });
        return false;
    });  
});  
</script>

<div class="row">
    <div class="col-md-12">
        <ul id="locationTab" class="nav nav-tabs">
          <li class="active"><a href="#search" data-toggle="tab">{{ _("Search") }}</a></li>
          <li><a href="#new" data-toggle="tab">{{ _("New") }}</a></li>
        </ul>
        <div id="locationTabContent" class="tab-content">
            <div class="tab-pane fade in active" id="search">
                <h3 class="title-box-form">{{ _("Search location by product") }}:</h3>
                <div id="message-get"></div>
                <form id="product-form" action="#" class="form-horizontal" method="POST">
                    <div class="clearfix ">
                        <input class="required ean-input" id="product-ean13" name="product-ean13" placeholder="EAN13" type="text" value="" autofocus="autofocus">
                    </div>
                    <div class="controls">
                        <button id="product-get-location" class="btn btn-primary btn-sm" type="submit">{{ _("Search") }}</button>
                    </div>
                </form>
            </div>
            <div class="tab-pane fade" id="new">
                <h3 class="title-box-form">{{ _("Add new product location") }}:</h3>
                <div id="message-save"></div>
                <form id="location-form" action="#" class="form-horizontal" method="POST">
                    {{ render_field(form.location, class_="", placeholder=_("Location")) }}
                    {{ render_field(form.ean13, class_="ean-input", placeholder=_("EAN13")) }}
                    <div class="controls">
                        <button id="product-save-location" class="btn btn-primary btn-sm" type="submit">{{ _("Save") }}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
/* Desactive Keyword ean input field */
$( "ean-input" ).blur(function() {});
</script>
{% endblock %}

